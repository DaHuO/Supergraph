def count N R P S answers = for start in R P S cur = start while len cur != 2 ** N new_cur = for x in cur if x == R new_cur += S R elif x == S new_cur += P S else new_cur += R P cur = new_cur if new_cur count R == R and new_cur count P == P and new_cur count S == S answers append join make_sort new_cur answers sort if len answers != 0 return answers 0 return IMPOSSIBLE 		14 33
def make_sort new_cur if len new_cur == 1 return new_cur middle = len new_cur // 2 left = make_sort new_cur middle right = make_sort new_cur middle if left < right return left + right else return right + left 		3 12
