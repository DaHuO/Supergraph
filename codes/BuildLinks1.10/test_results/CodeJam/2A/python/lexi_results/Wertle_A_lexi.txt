def recurse nR nP nS level if level == 0 if nR > 0 result 0 += R if nP > 0 result 0 += P if nS > 0 result 0 += S return level -= 1 count = 2 ** level / 3 target = 2 ** level leftP = count leftR = count leftS = count rightP = count rightR = count rightS = count nR -= 2 * count nP -= 2 * count nS -= 2 * count leftCount = 3 * count rightCount = 3 * count if nP > 0 leftP += 1 nP -= 1 leftCount += 1 if nR > 0 and leftCount < target and nS < 2 leftR += 1 nR -= 1 leftCount += 1 if nS > 0 and leftCount < target leftS += 1 nS -= 1 leftCount += 1 if nP > 0 rightP += 1 nP -= 1 if nR > 0 rightR += 1 nR -= 1 if nS > 0 rightS += 1 nS -= 1 if nR < 0 or nP < 0 or nS < 0 or leftP + leftR + leftS != 2 ** level or rightP + rightR + rightS != 2 ** level impossible 0 = True printe :( printe level = + str level printe nR = + str nR printe nP = + str nP printe nS = + str nS printe leftP = + str leftP + leftR =  + str leftR +  leftS =  + str leftS printe rightP = + str rightP + rightR =  + str rightR +  rightS =  + str rightS return recurse leftR leftP leftS level recurse rightR rightP rightS level 		42 102
def printe * stuff if enableDebug print * stuff file = sys stderr 		7 9
