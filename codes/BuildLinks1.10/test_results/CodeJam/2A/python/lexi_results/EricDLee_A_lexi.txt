def solve_case next N R P S = int n for n in next split ret = s N R P S if not ret return IMPOSSIBLE for n in range 1 N i = 2 ** n j = 2 ** N - n - 1 b = for k in range j step = 2 ** N * k / j b += join sorted ret step step + i ret step + i step + 2 * i ret = b return ret 		36 50
def s N R P S if N == 0 if P > 0 return P elif R > 0 return R else return S pr = P + R - S / 2 ps = P + S - R / 2 rs = R + S - P / 2 if pr < 0 or ps < 0 or rs < 0 return False last = s N - 1 rs pr ps if not last return False return join t x for x in last 		17 33
def solve next emit cases = int next for case in range 1 cases + 1 sol = solve_case next if isinstance sol list emit Case #{0}: format case for line in sol emit str line else emit Case #{0}: {1} format case str sol print {0} / {1} format case cases 		59 69
