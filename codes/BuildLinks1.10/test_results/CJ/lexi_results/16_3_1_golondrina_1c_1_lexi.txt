def find_plan np ans = n = len np paties = letters n d = dict zip paties np while d pd = for k v in d iteritems pd setdefault v append k paired_keys = unpaired_keys = for k v in pd iteritems if len v > 1 paired_keys append v else unpaired_keys append v if paired_keys for parties in unpaired_keys for p in parties ans append str p +  * d p del d p for parties in paired_keys for p in parties - 2 ans append str p +  * d p del d p pp1 = parties - 1 pp2 = parties - 2 ans append str pp1 + str pp2 +  * d pp1 del d pp1 del d pp2 else dd = sorted pd keys - 2 max1 = dd 1 max2 = dd 0 diff = max1 - max2 ppp = pd max1 0 ans append str ppp +  * diff d ppp = d ppp - diff ans = join ans return ans 		12 53
