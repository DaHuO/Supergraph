def main t = int raw_input for t in xrange t c j = map list raw_input split outc outj = solve c j 0 0 output t outc +  + outj 		116 125
def output t res casestr = case # + str t + 1 + : status = str res if res != none else impossible outputline = casestr + status print outputline 		5 9
def solve inc inj incmpcj ini c = inc j = inj l = len c cmpcj = incmpcj solutions = for i in xrange ini l if c i == ? and j i == ? if cmpcj == 0 c1 = c c1 i = 1 j1 = j j1 i = 0 c1 j1 = solve c1 j1 - 1 i + 1 solutions append c1 j1 c2 = c c2 i = 0 j2 = j j2 i = 1 c2 j2 = solve c2 j2 1 i + 1 solutions append c2 j2 c i = 0 j i = 0 elif cmpcj > 0 c i = 9 j i = 0 else c i = 0 j i = 9 elif c i != ? and j i != ? if cmpcj == 0 cmpcj = int j i - int c i elif c i == ? if cmpcj == 0 if int j i < 9 c1 = c c1 i = str int j i + 1 j1 = j c1 j1 = solve c1 j1 - 1 i + 1 solutions append c1 j1 if int j i > 0 c2 = c c2 i = str int j i - 1 j2 = j c2 j2 = solve c2 j2 1 i + 1 solutions append c2 j2 c i = j i elif cmpcj > 0 c i = 9 else c i = 0 else if cmpcj == 0 if int c i > 0 c2 = c j2 = j j2 i = str int c i - 1 c2 j2 = solve c2 j2 - 1 i + 1 solutions append c2 j2 if int c i < 9 c1 = c j1 = j j1 i = str int c i + 1 c1 j1 = solve c1 j1 1 i + 1 solutions append c1 j1 j i = c i elif cmpcj > 0 j i = 0 else j i = 9 c = join c j = join j if len solutions == 0 return c j solutions append c j diffs = for s in solutions intc = int s 0 intj = int s 1 diffs append abs intc - intj intc intj s 0 s 1 diffs sort key = lambda d d 2 diffs sort key = lambda d d 1 diffs sort key = lambda d d 0 return diffs 0 3 diffs 0 4 		12 113
