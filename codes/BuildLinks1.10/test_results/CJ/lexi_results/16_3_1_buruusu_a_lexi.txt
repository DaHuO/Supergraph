def solve n p freq = list list pair for pair in zip - n for n in p alphabet heapify freq head = freq 0 soln = while head 0 < 0 and not len freq == 2 and head 0 == - 1 n = - sum i 0 for i in freq if - head 0 < - 1 and - head 0 > n / 2 raise exception no! soln append head 1 f = head 0 head 0 += 1 heapify freq head = freq 0 freq = i for i in freq if i 0 < 0 if head 0 == f and len freq > 2 or head 0 < - 1 soln - 1 += head 1 head 0 += 1 heapify freq head = freq 0 freq = i for i in freq if i 0 < 0 if freq soln append freq 0 1 + freq 1 1 return  join soln 		5 35
