def get_best_repl c j first_mismatch cpre jpre = unify c j first_mismatch if first_mismatch == 0 or c first_mismatch - 1 != ? and j first_mismatch - 1 != ? cr = cpre + c first_mismatch replace ? 9 jr = jpre + j first_mismatch replace ? 0 return cr jr crem = c first_mismatch jrem = j first_mismatch c_best = cpre + crem replace ? 9 j_best = jpre + jrem replace ? 0 diff_best = int j_best - int c_best c2 = cpre + crem replace ? 0 j2 = jpre + jrem replace ? 9 to_add = 10 ** len c - first_mismatch c_x = int c2 + to_add if match c_x c diff_x = c_x - int j2 is_best = false if diff_x < diff_best is_best = true elif diff_x == diff_best and c_x < int c_best is_best = true elif diff_x == diff_best and c_x == int c_best and int j2 < int j_best is_best = true if is_best c_best = str c_x zfill len c j_best = j2 diff_best = diff_x j_x = int j2 - to_add if match j_x j diff_x = int c2 - j_x is_best = false if diff_x < diff_best is_best = true elif diff_x == diff_best and int c2 < int c_best is_best = true elif diff_x == diff_best and int c2 == int c_best and j_x < int j_best is_best = true if is_best c_best = c2 j_best = str j_x zfill len c diff_best = diff_x return c_best j_best 		43 104
def unify c j first_mismatch cl = jl = for i in range first_mismatch if c i != ? and j i != ? cl append c i jl append j i elif c i != ? cl append c i jl append c i elif j i != ? cl append j i jl append j i else cl append 0 jl append 0 cpre = join cl jpre = join jl return cpre jpre 		21 41
def solve t c j = sys stdin readline rstrip split first_mismatch = 0 for i in range len c if c i == j i first_mismatch += 1 continue elif c i == ? or j i == ? first_mismatch += 1 continue else break if first_mismatch == len c cr jr = unify c j first_mismatch print case #{}: {} {} format t cr jr return if c first_mismatch > j first_mismatch jr cr = get_best_repl j c first_mismatch else cr jr = get_best_repl c j first_mismatch print case #{}: {} {} format t cr jr 		106 131
def match num pattern l = len pattern if num < 0 return false if len str num > l return false s = str num zfill l for i in range l if pattern i != ? and pattern i != s i return false return true 		5 19
