def f c e d v = f j e d + 1 for j in r c if j != e if len v == 0 return d return max v 		30 34
def solve n a q = defaultdict int r = defaultdict list for i a in enumerate a q i + 1 = a r a append i + 1 pairs = set circles = for i in range 1 n + 1 visited = defaultdict bool c = i while not visited c visited c = true c = q c q = c cc = q c while cc != c q append cc cc = q cc if len q == 2 pairs add tuple sorted q else circles append q def f c e d v = f j e d + 1 for j in r c if j != e if len v == 0 return d return max v ans = 0 for p in pairs ans += 2 + f p 0 p 1 0 + f p 1 p 0 0 max_circle = 0 if circles max_circle = max len c for c in circles return max ans max_circle 		3 43
