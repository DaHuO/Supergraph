def solve i l v chain = false global m pp = none p = none z = i while v z is false v z = true l += 1 if not p is none pp = p p = z z = f z if z == i and not chain m = max m l if pp == z m = max m l if p in b l v = back l v p m = max m l for k in range n if not v k + 1 bv = list v solve k + 1 l bv true 		5 31
def main global v m f b n t = readint for t in range t n = readint f = b = for i in range n k = readint f i + 1 = k if not k in b b k = b k append i + 1 m = 0 for g in range n v = false for k in range n + 1 solve g + 1 0 v print n f answerln case # + str t + 1 + : + str m 		49 68
def back l v p global m bestl = l for q in b p bv = list v nl = l if bv q is false bv q = true nl += 1 if q in b nl bv = back nl bv q if nl > bestl bestl = nl v = bv return bestl v 		33 47
