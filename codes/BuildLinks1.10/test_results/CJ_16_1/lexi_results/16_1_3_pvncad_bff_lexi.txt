def get_ans bffs curr seen = set curr best_ans = if is_good bffs curr best_ans = curr for x in xrange len bffs if x in seen continue if can_add bffs curr x true new_curr = new_curr append x new_curr extend curr res = get_ans bffs new_curr if len res > len best_ans and is_good bffs res best_ans = res if can_add bffs curr x false new_curr = new_curr extend curr new_curr append x res = get_ans bffs new_curr if len res > len best_ans and is_good bffs res best_ans = res return best_ans 		23 48
def can_add bffs curr s is_left if len curr < 2 return true if is_left n nn = curr 0 curr 1 else n nn = curr - 1 curr - 2 return bffs n in nn s 		3 12
def is_good bffs curr for i x in enumerate curr good = bffs x in curr i - 1 curr i + 1 % len curr if not good return false return true 		14 21
