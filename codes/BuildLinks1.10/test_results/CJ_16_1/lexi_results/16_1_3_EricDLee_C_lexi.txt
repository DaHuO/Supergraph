def solve next emit cases = int next for case in range 1 cases + 1 sol = solve_case next if isinstance sol list emit case #{0}: format case for line in sol emit str line else emit case #{0}: {1} format case str sol print {0} / {1} format case cases 		52 62
def solve_case next n = int next bff = int n - 1 for n in next split best_closed = 0 cores = chains = for i in range n j = i visited = set l = while j not in visited visited add j l append j j = bff j if len l == 2 cores append tuple l elif j == l 0 best_closed = max best_closed len l elif j == l - 2 core = tuple l - 2 if core in chains chains core = max chains core len l - 2 else chains core = len l - 2 best_augmented = 0 for core in cores if core in chains best_augmented += 1 + chains core else best_augmented += 1 return max best_closed best_augmented 		12 43
