def main data = none if data is none f = sys stdin else f = stringio stringio data nt = int f readline for tc in xrange 1 nt + 1 n = int f readline papers = np array map int stripnl f readline split  dtype = np int32 for n in xrange 2 * n - 1 assert len papers 0 == n res = doit n papers msg case #%d: %s % tc res print case #%d: %s % tc res 		117 129
def stripnl s if s - 1 == \n return s - 1 return s 		112 115
def doit n p lp = len p a = np zeros n n dtype = np int32 pairs = for i in xrange n p sort lambda x y cmp x i y i if len p >= 2 and p 0 i == p 1 i pairs append p 0 p 1 p = p 2 else pairs append p 0 none missing = i p = p 1 a 0 = pairs 0 0 is_row = none if missing > 0 a 0 = pairs 0 1 is_row = false for ret in try_set a pairs 1 1 missing n is_row full is_row = ret if is_row sol = list full missing else sol = list full missing return  join map str sol return error ! 		67 97
def try_set a pairs l missing n is_row if len pairs == 0 yield a is_row else if l == missing p0 = pairs 0 0 row_ok = true col_ok = true for i in xrange n if a l i != 0 and a l i != p0 i row_ok = false if a i l != 0 and a i l != p0 i col_ok = false if row_ok b = np copy a b l = p0 for ret in try_set b pairs 1 l + 1 missing n false yield ret if col_ok b = np copy a b l = p0 for ret in try_set b pairs 1 l + 1 missing n true yield ret else p0 p1 = pairs 0 row_ok = true col_ok = true for i in xrange n if a l i != 0 and a l i != p0 i or a i l != 0 and a i l != p1 i row_ok = false if a i l != 0 and a i l != p0 i or a l i != 0 and a l i != p1 i col_ok = false if row_ok b = np copy a b l = p0 b l = p1 for ret in try_set b pairs 1 l + 1 missing n is_row yield ret if col_ok b = np copy a b l = p1 b l = p0 for ret in try_set b pairs 1 l + 1 missing n is_row yield ret 		19 62
