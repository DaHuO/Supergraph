def main cases = int raw_input for case in range 1 cases + 1 kidtotal = int raw_input bffs = int section - 1 for section in raw_input split  islooped = false * kidtotal longestloop = 0 doubles = for x in range kidtotal sofar = set order = if islooped x continue else current = x last = 0 while not current in sofar sofar add current order append current last = current current = bffs current if current == x for person in sofar islooped person = true if len sofar == 2 doubles append current last if longestloop < len sofar longestloop = len sofar doublelengths = carried = 0 for o in range kidtotal bestcarry = for x in range kidtotal current = x total = 0 while islooped current == false total += 1 current = bffs current carried current append total for x in carried bestcarry append max x for dub in doubles one two = dub total = bestcarry one + bestcarry two + 2 doublelengths append total doubletotal = sum doublelengths longest = longestloop if longest < doubletotal longest = doubletotal print case #%s: %s % case longest 		1 51
