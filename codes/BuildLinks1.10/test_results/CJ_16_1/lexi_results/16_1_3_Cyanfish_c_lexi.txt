def pairs b paired = set for p in b q = b p if b q == p paired add p paired add q return paired 		21 28
def longestchainendingin p b available longestchainlength = 0 l = set for a in available visited = a current = a while true current = b current if current == p chainlength = len visited if chainlength > longestchainlength longestchainlength = chainlength l = set visited break if current in visited or current not in available break visited add current return longestchainlength 		43 60
def largestcycle b longestcyclelength = 0 for start in b visited = start current = start while true current = b current if current in visited if current == start cyclelength = len visited if cyclelength > longestcyclelength longestcyclelength = cyclelength break visited add current return longestcyclelength 		5 19
def pairchain b paired = pairs b unpaired = set b keys difference paired count = len paired for p in paired count += longestchainendingin p b unpaired return count 		62 68
def solve case n = case readint b = dict for i in range n q = case readint b i + 1 = q x = largestcycle b y = pairchain b print x y return max x y 		70 79
def pairgeneration b currentgen = pairs b anygen = set currentgen while len currentgen > 0 lastgen = currentgen currentgen = set for p in b if p not in anygen and b p in lastgen lastgen remove b p currentgen add p anygen add p return len anygen 		30 41
