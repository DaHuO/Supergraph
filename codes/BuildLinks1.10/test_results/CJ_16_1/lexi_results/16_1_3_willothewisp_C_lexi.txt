def go n f loop = 0 for start in range n mark = i = start k = 0 while i not in mark mark i = k i = f i k += 1 loop = max loop k - mark i quiver = for _ in range n for i in range n quiver f i append i vis = set horns = 0 for i in range n if f f i == i and i not in vis and f i not in vis vis add i vis add f i sofar = 0 0 for side start in enumerate i f i frontier = deque start 0 while frontier u k = frontier popleft for v in quiver u if v != i and v != f i frontier appendleft v k + 1 sofar side = max sofar side k horns += sofar 0 + sofar 1 + 2 return max loop horns 		5 37
