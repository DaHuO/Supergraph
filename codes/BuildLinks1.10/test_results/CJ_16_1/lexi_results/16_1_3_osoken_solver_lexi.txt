def solve m ords = map lambda i get_ord i m range 1 len m + 1 r = for z in i + 1 for i o in enumerate ords if o == 0 bff = m z - 1 if bff not in r r bff = r bff append z sinkords = 0 0 for t in i + 1 for i o in enumerate ords if o == 2 p = tuple sorted t m t - 1 if p not in sinkords sinkords p = get_sinkord p r 2 return max max ords sum sinkords values 		7 20
def get_sinkord p r d flg = true if flg if p 0 not in r return get_sinkord p r d false best = d for n in r p 0 cand = get_sinkord n p 1 r d + 1 true if best < cand best = cand return best else if p 1 not in r return d best = d for n in r p 1 cand = get_sinkord p 0 n r d + 1 false if best < cand best = cand return best 		36 54
def get_ord id m mem = set s = m id - 1 mem add s while true if m s - 1 == id return len mem + 1 if m s - 1 in mem return 0 mem add m s - 1 s = m s - 1 		23 33
