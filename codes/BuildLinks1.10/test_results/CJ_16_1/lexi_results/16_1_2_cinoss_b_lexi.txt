def visit k global a finished if k >= n finished = true if finished return if len pairs k == 1 p = pairs k 0 ok = true for i in xrange k if len b i > 0 and b i k != p i ok = false break if ok a append p b append visit k + 1 if finished return a pop b pop else for t in xrange 2 p = pairs k t p1 = pairs k 1 - t ok = true for i in xrange n if map col k a != p k ok = false break for i in xrange k if len b i > 0 and b i k != p1 i ok = false break if ok a append pairs k 1 - t b append pairs k t visit k + 1 if finished return a pop b pop 		24 70
