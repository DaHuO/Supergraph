def main t = int input for t in range 1 t + 1 params = parse result = solve * params print case #%d: %s % t result 		74 82
def solve n f a = i set for i in range n for i f in enumerate f a f add i result = - 1 for beg in range n cur = beg circle = cur circle_set = set cur count = 1 last = - 1 while true next = f cur if next in circle last = next break count += 1 circle_set add next circle append next cur = next result = max count - circle index last result pairs = for i in range n for j in range i + 1 n if f i == j and f j == i pairs append i j all_pairs_count = 0 for pair in pairs all_pairs_count += 2 count = 0 _p = set pair for cur_layer in set pair 0 set pair 1 done = cur_layer copy to_add = 0 while true cur_a = set for c in cur_layer cur_a = cur_a union a c cur_a = cur_a difference done difference _p if len cur_a == 0 break count += 1 to_add += 1 done = done union cur_a cur_layer = cur_a all_pairs_count += count result = max all_pairs_count result return result 		1 62
def parse n = int input f = int i - 1 for i in input split return n f 		65 71
