def search troop record index n if index == len record return troop line = record index if line 0 in troop 0 ind = troop 0 index line 0 match = true for i in range n if troop i ind not in 0 line i match = false break if match templine = troop i ind for i in range n for i in range n troop i ind = line i ret = search troop record index + 1 n if ret is not none return ret for i in range n troop i ind = templine i vertfirst = troop i 0 for i in range n if line 0 in vertfirst ind = vertfirst index line 0 match = true for i in range n if troop ind i not in 0 line i match = false break if match templine = troop ind i for i in range n for i in range n troop ind i = line i ret = search troop record index + 1 n if ret is not none return ret for i in range n troop ind i = templine i return none 		57 97
def solve n a troop = 0 * n for i in range n minh = min line 0 for line in a usedlines = false * len a firsthorizontalfilled = false firstverticalfilled = false count = 0 for line in a if line 0 == minh if firsthorizontalfilled for i in range n troop i 0 = line i firstverticalfilled = true else troop 0 = line firsthorizontalfilled = true usedlines count = true count += 1 if not firsthorizontalfilled or not firstverticalfilled b = - x for x in line - 1 for line in a - 1 res = solve n b res = - x for x in res - 1 return res duplines = count = 0 for line in a if not usedlines count and a count line > 1 duplines += line usedlines count = true count += 1 for line in duplines ind = troop 0 index line 0 troop ind = line for i in range n troop i ind = line i record = a i for i in range 2 * n - 1 if not usedlines i result = search troop record 0 n correctrecord = line for line in result for index in range n vertical = result i index for i in range n correctrecord += vertical usedlines = false * len a for line in correctrecord count = 0 found = false for target in a if not usedlines count and target == line usedlines count = true found = true break count += 1 if not found return line count += 1 return none 		1 55
