def recursebffs n bffs ind mutualpairs ct covered start if ind in mutualpairs return ct ind if ind in covered if ind == start return ct - 1 else return 0 - 1 else covered add ind return recursebffs n bffs bffs ind mutualpairs ct + 1 covered start 		66 77
def readthroughdatageneric filename outputs = f = open filename r lct = 0 for line in f readlines if lct == 0 pass else if len line strip split  < 3 pass else parts = line strip split  n = len parts + 1 bffs = np zeros n dtype = np int for i in range 1 n bffs i = int parts i - 1 outputs append solve n bffs lct += 1 f close return outputs 		14 34
def solve n bffs mutualpairs = for i in range 1 n if i < bffs i and bffs bffs i == i mutualpairs append i mutualpairs append bffs i ending_lengths = for i in range 1 n chainendlength = recursebffs n bffs i mutualpairs 0 set i if chainendlength 1 in ending_lengths and ending_lengths chainendlength 1 >= chainendlength 0 continue ending_lengths chainendlength 1 = chainendlength 0 runsum = len mutualpairs for i in ending_lengths if i == - 1 continue runsum += ending_lengths i print ending_lengths if - 1 not in ending_lengths return runsum else return max runsum ending_lengths - 1 		36 64
