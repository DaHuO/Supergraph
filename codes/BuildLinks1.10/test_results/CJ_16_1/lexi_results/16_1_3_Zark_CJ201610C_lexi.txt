def output self caseindex stdout write case #%d: %d\n % caseindex self result 		74 75
def input self self num = int stdin readline self bff = int _ - 1 for _ in stdin readline split 		12 14
def findcircle self st isvisited = false for _ in range self num p = st count = 0 while not isvisited p isvisited p = true p = self bff p count += 1 if p == st return count else return 0 		41 52
def findline self st linelen = 0 for _ in range self num queue = queue append st head = 0 tail = 1 while head < tail p = queue head head += 1 for pp in self counterbff p if pp == st or pp == self bff st or linelen pp > 0 continue linelen pp = linelen p + 1 queue append pp tail += 1 maxlen = 0 for _ in range self num maxlen = max maxlen linelen _ return maxlen 		54 72
def run self casenum = int stdin readline for caseindex in range casenum self input self exe self output caseindex + 1 		5 10
def exe self self counterbff = for _ in range self num for i in range self num self counterbff self bff i append i circlelen = for i in range self num circlelen append self findcircle i linelen = for i in range self num if self bff self bff i == i linelen append self findline i else linelen append 0 self result = 0 for i in range self num self result = max self result circlelen i alter = 0 for i in range self num if self bff self bff i == i and i < self bff i alter += linelen i + linelen self bff i + 2 self result = max self result alter 		16 39
