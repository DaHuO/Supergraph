def bff students incycles = set isocomps = for student in students 1 if students students student == student and student not in isocomps isocomps student = students student 0 isocomps students student = student 0 maxsize = 0 for student in range 1 len students nextst = student iscycle = false isiso = false excludinglast2 = set path = student size = 1 if student not in isocomps while not iscycle and not isiso nextst = students nextst if nextst in excludinglast2 iscycle = true incycles update path idx = path index nextst size = len path - idx elif nextst in incycles size = 0 iscycle = true elif nextst in isocomps isocomps nextst 1 append size isiso = true else path append nextst size += 1 if len path >= 3 excludinglast2 add path len path - 3 if size > maxsize maxsize = size num = 0 for student in isocomps num += max isocomps student 1 if maxsize < num + len isocomps maxsize = num + len isocomps return maxsize 		41 105
