def main t = input for t in range t ans = calc print case #%d: %s % t + 1 ans 		65 69
def calc n = input f = int x - 1 for x in raw_input split db = none for i in range n mx = none for i in range n hd = none for i in range n ln = none for i in range n for i in range n if f f i == i db i = f i mx i = 0 hd i = i ln i = 0 mc = 0 for i in range n if hd i is not none continue stack = i hd i = - 1 while hd f i is none i = f i stack append i hd i = - 1 if hd f i == - 1 l = 1 fg = true while stack j = stack pop if j == f i fg = false mc = max mc l hd j = - 2 if fg l += 1 elif hd f i == - 2 pass else l = 1 while stack j = stack pop hd j = hd f i ln j = ln f i + l mx hd j = max mx hd j ln j l += 1 ans1 = mc ans2 = 0 for i in range n if hd i == i ans2 += mx i + 1 return max ans1 ans2 		4 62
