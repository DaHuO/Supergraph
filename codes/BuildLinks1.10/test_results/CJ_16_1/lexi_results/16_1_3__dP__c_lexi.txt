def sol n f vis = 0 * n res = 0 def dfs i l if vis i r = l - vis i else vis i = l r = dfs f i l + 1 vis i = 2 * n return r for i in xrange n if not vis i res = max dfs i 1 res def lc i ii q = i l = 0 * n for x in q for j k in enumerate f if k == x and j != ii q append j l j = l x + 1 return max l np = 0 for j i in enumerate f if f i == j and j < i np += lc i j + lc j i + 2 return max res np 		5 38
def dfs i l if vis i r = l - vis i else vis i = l r = dfs f i l + 1 vis i = 2 * n return r 		9 17
def lc i ii q = i l = 0 * n for x in q for j k in enumerate f if k == x and j != ii q append j l j = l x + 1 return max l 		23 31
