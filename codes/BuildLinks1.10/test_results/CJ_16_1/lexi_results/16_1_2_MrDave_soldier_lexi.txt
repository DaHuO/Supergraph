def solve_test test_case n = len test_case + 1 / 2 res = process n n u test_case r c return res 		110 113
def check d = c r 0 1 2 3 u 1 2 3 2 3 5 3 5 6 2 3 4 n 3 print is_ok d 		25 30
def main filename test_lst = read_file filename for i_test test_case in enumerate test_lst res = solve_test test_case print case #%i: %s % 1 + i_test  join str e for e in res 		116 120
def extract_sol d t = n = d n for i in xrange n if i in d r t append d r i else t append none * n for i in xrange n if i in d c c = d c i is_ok = true for i_e e in enumerate c if t i_e i is none t i_e i = e for i in xrange n if i not in d r return t i if i not in d c return e i for e in t 		66 85
def process d if len d u == 0 return extract_sol d else l = d u pop for i in xrange d n d1 = copy deepcopy d if i not in d1 r d1 r i = l if is_ok d1 res = process d1 if res is not none return res d2 = copy deepcopy d if i not in d2 c d2 c i = l if is_ok d2 res = process d2 if res is not none return res 		88 107
def read_file filename f = open filename csv_r = csv reader f delimiter =  t = int csv_r next 0 test_lst = for i in xrange t n = int csv_r next 0 test = for _ in range 2 * n - 1 test append int e for e in csv_r next test_lst append test f close return test_lst 		10 22
def is_ok d t = n = d n for i in xrange n if i in d r t append d r i else t append none * n for i in xrange n if i in d c c = d c i is_ok = true for i_e e in enumerate c if t i_e i is not none and t i_e i != e return false if t i_e i is none t i_e i = e for i in xrange n row = e for e in t i if e is not none s_row = row s_row sort if len row > 0 and row != s_row return false for i in xrange n col = e i for e in t if e i is not none s_col = col s_col sort if len col > 0 and col != s_col return false return true 		33 63
