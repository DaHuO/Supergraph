def doTest line allChars = line q = deque for idx in range len allChars q append allChars idx + allChars idx + allChars idx + 1 solutions = while len q > 0 remainingCs workingWord workingDigits = q pop if len remainingCs == 0 return join x for x in sorted workingDigits if len workingWord == 0 if remainingCs 0 in firstChars for idx in range len remainingCs 1 remainingChars = remainingCs 1 idx + remainingCs 1 idx + remainingCs 1 idx + 1 q append remainingChars remainingCs 0 workingDigits else newWord = workingWord + remainingCs 0 if newWord in wordToDigit if len remainingCs 1 == 0 q append workingDigits + wordToDigit newWord else for idx in range len remainingCs 1 q append remainingCs 1 idx + remainingCs 1 idx + remainingCs 1 idx + 1 workingDigits + wordToDigit newWord else for w in wordToDigit keys if w find newWord == 0 for idx v in enumerate remainingCs 1 q append remainingCs 1 idx + remainingCs 1 idx + remainingCs 1 idx + 1 newWord workingDigits return 		8 37
