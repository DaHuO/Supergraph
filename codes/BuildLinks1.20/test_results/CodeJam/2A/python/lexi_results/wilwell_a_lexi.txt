def count n r p s answers = for start in r p s cur = start while len cur != 2 ** n new_cur = for x in cur if x == r new_cur += s r elif x == s new_cur += p s else new_cur += r p cur = new_cur if new_cur count r == r and new_cur count p == p and new_cur count s == s answers append join make_sort new_cur answers sort if len answers != 0 return answers 0 return impossible 		14 33
def make_sort new_cur if len new_cur == 1 return new_cur middle = len new_cur // 2 left = make_sort new_cur middle right = make_sort new_cur middle if left < right return left + right else return right + left 		3 12
