def sort_sub word num cur = 0 ret = while cur < len word sub1 = word cur cur + num cur += num sub2 = word cur cur + num cur += num ret += min sub1 sub2 + max sub1 sub2 return ret 		24 33
def count tour r p s = 0 0 0 for c in tour if c == r r += 1 elif c == p p += 1 elif c == s s += 1 return r p s 		43 52
def gen initial num_rounds trans for i in range num_rounds tour = for c in initial tour += trans c initial = tour return initial 		35 41
def sort word n = 1 while n < len word word = sort_sub word n n *= 2 return word 		17 22
def solve infile outfile trials = int infile readline transitions = r sr p pr s ps for trial in range 1 trials + 1 num_rounds r p s = int val for val in infile readline strip split final = gen p num_rounds transitions if r p s != count final final = gen r num_rounds transitions if r p s != count final final = gen s num_rounds transitions if r p s != count final final = impossible if final != impossible final = sort final outfile write case #{}: {}\n format trial final 		1 15
