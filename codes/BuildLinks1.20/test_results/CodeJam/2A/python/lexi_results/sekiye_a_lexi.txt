def solve n r p s for i in xrange n r = 0 p = 0 s = 0 while r > 0 or p > 0 or s > 0 if r > 0 and p == 0 and s == 0 return impossible if r == 0 and p > 0 and s == 0 return impossible if r == 0 and p == 0 and s > 0 return impossible if min r p s == s and r > 0 and p > 0 p += 1 r -= 1 p -= 1 if min r p s == r and p > 0 and s > 0 s += 1 p -= 1 s -= 1 if min r p s == p and s > 0 and r > 0 r += 1 s -= 1 r -= 1 r = r p = p s = s ans = if r > 0 ans = r if p > 0 ans = p if s > 0 ans = s for i in xrange n s = for ch in ans if ch == r s += rs if ch == s s += ps if ch == p s += pr ans = s l = list ans for i in xrange n x = 2 ** n - i - 1 y = 2 ** i for j in xrange x i1 = 2 ** y * j i2 = i1 + y i3 = i2 + y if l i1 i2 > l i2 i3 l i1 i2 l i2 i3 = l i2 i3 l i1 i2 return join l 		3 57
