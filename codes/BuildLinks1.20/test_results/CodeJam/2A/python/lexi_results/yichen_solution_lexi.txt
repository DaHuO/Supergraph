def solve case_number input_numbers = int s for s in raw_input split  n r p s = input_numbers total = 2 ** n ans = play total r p s if ans == impossible print case #{}: {} format case_number ans return if n > 1 ans = sor ans n total print case #{}: {} format case_number ans 		57 67
def play n r p s total = r + p + s half = total / 2 if r > half or p > half or s > half return impossible if total == 2 res = if p res += p if r res += r if s res += s return res ar = r + s - p / 2 as = p + s - r / 2 ap = r + p - s / 2 next = play n ar ap as if next == impossible return impossible else if n == total res = for i in next if i == r res += rs elif i == p res += pr else res += ps return res else res = for i in next if i == r res += rs elif i == p res += pr else res += ps return res 		1 41
def sor strs n total for i in range n - 1 new_strs = length = 2 ** n - i - 2 for e in range length a = strs 2 * e b = strs 2 * e + 1 if b < a a b = b a new_strs += a + b strs = new_strs return join strs 		43 54
