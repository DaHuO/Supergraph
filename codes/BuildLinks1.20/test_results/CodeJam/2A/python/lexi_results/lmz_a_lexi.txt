def walk p r s n = p + r + s nn = n while nn % 2 == 0 nn /= 2 if nn != 1 return none m = n / 3 if not p == m or p == m + 1 and r == m or r == m + 1 and s == m or s == m + 1 return none if n == 1 if p == 1 return p if r == 1 return r if s == 1 return s raise arg if n == 2 if p == 0 return rs if r == 0 return ps if s == 0 return pr key = p r s if key in cache return cache key res = none for p r s in itertools product p / 2 p - p / 2 r / 2 r - r / 2 s / 2 s - s / 2 w1 = walk p r s w2 = walk p - p r - r s - s if w1 is not none and w2 is not none w = w1 + w2 if res is none or w < res res = w cache key = res return res 		11 38
