def recurse nr np ns level if level == 0 if nr > 0 result 0 += r if np > 0 result 0 += p if ns > 0 result 0 += s return level -= 1 count = 2 ** level / 3 target = 2 ** level leftp = count leftr = count lefts = count rightp = count rightr = count rights = count nr -= 2 * count np -= 2 * count ns -= 2 * count leftcount = 3 * count rightcount = 3 * count if np > 0 leftp += 1 np -= 1 leftcount += 1 if nr > 0 and leftcount < target and ns < 2 leftr += 1 nr -= 1 leftcount += 1 if ns > 0 and leftcount < target lefts += 1 ns -= 1 leftcount += 1 if np > 0 rightp += 1 np -= 1 if nr > 0 rightr += 1 nr -= 1 if ns > 0 rights += 1 ns -= 1 if nr < 0 or np < 0 or ns < 0 or leftp + leftr + lefts != 2 ** level or rightp + rightr + rights != 2 ** level impossible 0 = true printe :( printe level = + str level printe nr = + str nr printe np = + str np printe ns = + str ns printe leftp = + str leftp + leftr =  + str leftr +  lefts =  + str lefts printe rightp = + str rightp + rightr =  + str rightr +  rights =  + str rights return recurse leftr leftp lefts level recurse rightr rightp rights level 		42 102
def printe * stuff if enabledebug print * stuff file = sys stderr 		7 9
