def resort ans n = len ans if n == 2 return join sorted ans else left = resort ans n / 2 right = resort ans n / 2 lr = left + right rl = right + left if lr < rl return lr else return rl 		43 55
def solve n r p s if r < 0 or p < 0 or s < 0 return impossible - 1 if n == 0 if r > 0 return r 0 elif p > 0 return p 0 elif s > 0 return s 0 a = p + s - r / 2 b = p + r - s / 2 c = s + r - p / 2 p -= a s -= c r -= b string result = solve n - 1 r p s if result == - 1 return string result else new_string = for c in string if c == p new_string += pr elif c == r new_string += sr elif c == s new_string += ps else print fuck! return new_string result 		6 41
