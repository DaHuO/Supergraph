def main t = int input for case_num in range 1 t + 1 n r p s = map int input split works = true counts = get_counts p r s if any any v < 0 for v in row for row in counts print case #{}: impossible format case_num else print case #{}: {} format case_num solve counts - 1 n 		59 69
def solve l n out = if l 0 out = p elif l 1 out = r else out = s for x in range n nx = for c in out if c == p nx += pr elif c == r nx += rs else nx += ps if len nx & len nx - 1 == 0 l = 1 while l < len nx a = - 2 * l b = - l nx = nx a + min nx a nx b + nx a b l <<= 1 out = nx return out 		29 57
def get_counts p r s counts = p r s while p + r + s > 1 p s r = p + r - s // 2 p - r + s // 2 r - p + s // 2 counts append p r s return counts 		21 27
def winner a b if a > b return winner b a if a == p and b == r return p if a == p and b == s return s if a == r and b == s return r 		1 9
def valid moves while len moves > 1 n = for i in range 0 len moves 2 if moves i == moves i + 1 return false n += winner moves i moves i + 1 moves = n return true 		11 19
