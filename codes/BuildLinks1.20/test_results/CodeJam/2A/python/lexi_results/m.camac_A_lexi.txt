def recur n r p s global memo if r p s in memo return memo r p s if n % 3 == 1 if r - 1 == p == s a b = recur n / 2 r / 2 r / 2 - 1 r / 2 recur n / 2 r / 2 r / 2 r / 2 - 1 if r == p - 1 == s a b = recur n / 2 p / 2 - 1 p / 2 p / 2 recur n / 2 p / 2 p / 2 p / 2 - 1 if r == p == s - 1 a b = recur n / 2 s / 2 - 1 s / 2 s / 2 recur n / 2 s / 2 s / 2 - 1 s / 2 else if r == p == s + 1 a b = recur n / 2 s / 2 + 1 s / 2 s / 2 recur n / 2 s / 2 s / 2 + 1 s / 2 if r == p + 1 == s a b = recur n / 2 p / 2 + 1 p / 2 p / 2 recur n / 2 p / 2 p / 2 p / 2 + 1 if r + 1 == p == s a b = recur n / 2 r / 2 r / 2 + 1 r / 2 recur n / 2 r / 2 r / 2 r / 2 + 1 ans = a + b if a < b else b + a memo r p s = ans return ans 		28 50
def win x y if x == y return none if x y == r p return p if x y == p s return s return r 		3 10
def simul s if len s == 1 return true nr = for i in range len s / 2 res = win s 2 * i s 2 * i + 1 if res is none return false nr += res return simul nr 		12 20
def solve n r p s if abs r - p >= 2 or abs p - s >= 2 or abs s - r >= 2 return impossible ans = recur 2 ** n r p s c = counter ans assert not c r != r or c p != p or c s != s return ans return impossible 		55 70
