def parse n r p s = int x for x in input split return n r p s 		43 48
def solve n r p s for win in r p s s = win for i in range n next_s = for c in s next_s += _map c s = next_s _r = 0 _p = 0 _s = 0 for c in s if c == r _r += 1 if c == p _p += 1 if c == s _s += 1 if r == _r and p == _p and s == _s for i in range n next_s = cur = 0 interval = 2 ** i while cur < 2 ** n left = s cur cur + interval right = s cur + interval cur + interval * 2 if left < right next_s += left + right else next_s += right + left cur += 2 * interval s = next_s return s return impossible 		6 40
def main t = int input for t in range 1 t + 1 params = parse result = solve * params print case #%d: %s % t result 		51 59
