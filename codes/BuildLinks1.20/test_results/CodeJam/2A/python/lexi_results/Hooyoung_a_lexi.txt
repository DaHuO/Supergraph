def solve x r p s if x r p s in memo return memo x r p s out = false if r + p + s == 1 if x == 0 and r == 1 out = r elif x == 1 and p == 1 out = p elif x == 2 and s == 1 out = s else n = r + p + s / 2 for r in xrange 0 min r n + 1 for p in xrange 0 min p n - r + 1 s = n - r - p if s <= s a = solve x r p s b = solve x + 2 % 3 r - r p - p s - s if a and b and not out or a + b < out out = a + b a = solve x + 2 % 3 r p s b = solve x r - r p - p s - s if a and b and not out or a + b < out out = a + b memo x r p s = out return out 		3 30
