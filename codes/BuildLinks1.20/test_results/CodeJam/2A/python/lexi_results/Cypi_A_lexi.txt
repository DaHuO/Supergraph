def build n r p s assert not invalid n r p s if n == 1 if p > 0 and r > 0 return pr if p > 0 and s > 0 return ps return rs if p == r > s pl rl sl = p + 1 / 2 r / 2 s / 2 elif p == s > r pl rl sl = p + 1 / 2 r / 2 s / 2 elif p > r == s pl rl sl = p / 2 r + 1 / 2 s / 2 elif r == s > p pl rl sl = p / 2 r + 1 / 2 s / 2 elif r > s == p pl rl sl = p + 1 / 2 r / 2 s / 2 elif s > r == p pl rl sl = p + 1 / 2 r / 2 s / 2 else assert false return build n - 1 rl pl sl + build n - 1 r - rl p - pl s - sl 		7 28
def invalid n r p s n = 1 << n if max r p s > n + 2 / 3 return true if min r p s < n / 3 return true return false 		1 5
